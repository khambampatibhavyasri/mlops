schema: '2.0'
stages:
  ingest:
    cmd: python src/ingest/ingest.py data/raw/sales.csv --out 
      data/interim/ingested.csv
    deps:
    - path: data/raw/sales.csv
      hash: md5
      md5: fbfb1af9b215a8e3bc011d2ac5011257
      size: 3434497
    - path: src/ingest/ingest.py
      hash: md5
      md5: e150c308762489e18d80b5cb1a3fbd49
      size: 1089
    outs:
    - path: data/interim/ingested.csv
      hash: md5
      md5: fbfb1af9b215a8e3bc011d2ac5011257
      size: 3434497
  features:
    cmd: "python src/features/build_features.py --in data/interim/ingested.csv --out
      data/processed/features.csv --target units --use-one-hot true --include-price
      true --include-promo true --include-holiday true --include-competitor-diff true\n"
    deps:
    - path: data/interim/ingested.csv
      hash: md5
      md5: fbfb1af9b215a8e3bc011d2ac5011257
      size: 3434497
    - path: params.yaml
      hash: md5
      md5: a01eaea90c5f72626fdcf732208fea9f
      size: 175
    - path: src/features/build_features.py
      hash: md5
      md5: 32dd1043a83db74e6d9058413c7b1b55
      size: 3579
    params:
      params.yaml:
        features.include_competitor_diff: true
        features.include_holiday: true
        features.include_price: true
        features.include_promo: true
        features.use_one_hot: true
        train.target: units
    outs:
    - path: data/processed/features.csv
      hash: md5
      md5: 319eae83c796c30ee0cde9bb99b8c088
      size: 9973521
  train:
    cmd: "python src/models/train_baseline.py --in data/processed/features.csv --model
      models/baseline_linear.json --metrics models/metrics_baseline.json --alpha 2.0
      --target units\n"
    deps:
    - path: data/processed/features.csv
      hash: md5
      md5: 319eae83c796c30ee0cde9bb99b8c088
      size: 9973521
    - path: params.yaml
      hash: md5
      md5: a01eaea90c5f72626fdcf732208fea9f
      size: 175
    - path: src/models/train_baseline.py
      hash: md5
      md5: a9bfb1cb204e51d4c0c64205e8951d77
      size: 3102
    params:
      params.yaml:
        features.include_competitor_diff: true
        features.include_holiday: true
        features.include_price: true
        features.include_promo: true
        features.use_one_hot: true
        train.alpha: 2.0
        train.target: units
    outs:
    - path: models/baseline_linear.json
      hash: md5
      md5: a7aecac9d3e91bf141ccc6f723fce839
      size: 2723
    - path: models/metrics_baseline.json
      hash: md5
      md5: 3e9fe8568cb06fc2914f0fdee3dd8de3
      size: 76
  automl_pycaret:
    cmd: "python src/automl/pycaret_regression.py --in data/processed/features.csv
      --target units --leaderboard reports/pycaret_leaderboard.csv --pred-sample reports/pycaret_predictions_sample.csv
      --model-dir models/pycaret_best --metrics reports/pycaret_metrics.json --experiment-name
      pycaret-regression --tracking-uri file:./mlruns\n"
    deps:
    - path: data/processed/features.csv
      hash: md5
      md5: 319eae83c796c30ee0cde9bb99b8c088
      size: 9973521
    - path: params.yaml
      hash: md5
      md5: a01eaea90c5f72626fdcf732208fea9f
      size: 175
    - path: src/automl/pycaret_regression.py
      hash: md5
      md5: b1e1a51e56d6b40f80c28595324ff1fa
      size: 4012
    params:
      params.yaml:
        train.target: units
    outs:
    - path: models/pycaret_best.pkl
      hash: md5
      md5: 6e9ea6ee1669deb8b4e38c30baea410b
      size: 192915
    - path: reports/pycaret_leaderboard.csv
      hash: md5
      md5: 3273ed4cae0fe6842caebe69cb43ce07
      size: 1407
    - path: reports/pycaret_metrics.json
      hash: md5
      md5: 8ca1fb46cc512f3be3efb12bfae2886b
      size: 77
    - path: reports/pycaret_predictions_sample.csv
      hash: md5
      md5: 525eab8d879138f3718c95e4effd3dc7
      size: 35653
